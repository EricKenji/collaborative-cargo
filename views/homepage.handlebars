<article class="post card">
      <div class="title card-header">
        <p id="white">Real Time Global Chat</p>
      </div>
      <div class="card-body">
        <form id="chat-form">
          <div class="chat-messages"></div>
          <input type="text" class="form-input" id='message'/>
          <button class="btn">Send</button>
        </form>
      </div>
</article>

<ol class="post-list">
  {{#each posts as |post|}}
  <li>
     {{> post-info post }}
  </li>
  {{/each}}
</ol>

<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
    var socket = io();

    var username = 'User'

    if (document.querySelector('#white').textContent.split(' ')[3] != 'Chat') {
      var username = document.querySelector('#white').textContent.split(' ')[3]
    }

    const chatForm = document.getElementById('chat-form')

    

    socket.on('connection')

    socket.on('message', message => {
      outputMessage(message);
    })

    chatForm.addEventListener('submit', event => {
      event.preventDefault();

      const message = (`<strong>${username}:</strong> ${event.target.elements.message.value}`);

      socket.emit('chatMessage', message);
    })

    function outputMessage(message) {
      const div = document.createElement('div');
      div.classList.add('message');
      div.innerHTML = `<p class="text">${message}</p>`;
      document.querySelector('.chat-messages').appendChild(div);
    }
</script>